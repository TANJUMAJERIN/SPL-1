#include<bits/stdc++.h>
#include <fstream>
#include <cstdio>
#include <cerrno>
#include <string.h>
#include <dirent.h>
#include <stdbool.h>
#include"file_main.h"
using namespace std;
int main()
{
    cout<<"\n            Welcome to 'Malware Detection System'         \n";
while(2){

   cout<<"\nDo you want to test a file or a folder whether it is malware or not?"<<endl;
   cout<<"If so then select an option please----\n";
   cout<<"  1.A file\n";
   cout<<"  2.A folder\n";
   cout<<"  3.Exit\n";
   int option;
   cin>>option;
   std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n');
   if(option==1){
        cout<<"Enter the file path please"<<endl;
   string filepath;

    std::getline(std::cin, filepath);
    check(filepath);
    }
else if(option==2){

    cout<<"Enter the Folder path"<<endl;
    string folderPath ;

    std::getline(std::cin, folderPath );
    DIR* dir;
    struct dirent* entry;

    if ((dir = opendir(folderPath.c_str())) != nullptr) {
        while ((entry = readdir(dir)) != nullptr) {
            std::string fileName = entry->d_name;
            if (fileName != "." && fileName != "..") {
                std::string filePath = folderPath + "\\" + fileName;

                std::cout << "File path: " << filePath << std::endl;
                cout<<"\ntesting---------------------"<<endl;
                check(filePath);
            }
        }
        closedir(dir);
    } else {
        std::cout << "Failed to open the directory." << std::endl;
        return 1;
    }




}
else
    return 0;
    }
}
